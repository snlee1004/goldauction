@startuml 시퀀스_다이어그램_경매_입찰
!theme plain
skinparam defaultFontName "Malgun Gothic"
skinparam sequenceMessageAlign center
skinparam sequenceArrowThickness 2

actor 사용자 as User
participant "Frontend\n(React)" as Frontend
participant "ImageboardController" as Controller
participant "ImageboardService" as Service
participant "BidService" as BidService
participant "Oracle DB" as DB

== 경매 상품 등록 ==
User -> Frontend: 상품 등록 요청
activate Frontend
Frontend -> Frontend: 입력 검증
Frontend -> Controller: POST /imageboard/imageboardWrite
activate Controller
Controller -> Service: imageboardWrite()
activate Service
Service -> DB: INSERT INTO IMAGEBOARD1
activate DB
DB --> Service: 성공
deactivate DB
Service -> DB: INSERT INTO IMAGEBOARD_IMAGES1 (다중 이미지)
activate DB
DB --> Service: 성공
deactivate DB
Service --> Controller: 결과 반환
deactivate Service
Controller --> Frontend: JSON 응답
deactivate Controller
Frontend --> User: 등록 완료
deactivate Frontend

== 경매 상품 조회 ==
User -> Frontend: 상품 목록 조회
activate Frontend
Frontend -> Controller: GET /imageboard/imageboardList
activate Controller
Controller -> Service: imageboardList()
activate Service
Service -> DB: SELECT FROM IMAGEBOARD1
activate DB
DB --> Service: 상품 목록
deactivate DB
Service --> Controller: 상품 목록
deactivate Service
Controller --> Frontend: JSON 응답
deactivate Controller
Frontend --> User: 상품 목록 표시
deactivate Frontend

== 입찰 등록 ==
User -> Frontend: 입찰하기
activate Frontend
Frontend -> Frontend: 입찰 금액 검증
Frontend -> Controller: POST /bid/write
activate Controller
Controller -> Service: imageboardView()
activate Service
Service -> DB: SELECT FROM IMAGEBOARD1
activate DB
DB --> Service: 경매 정보
deactivate DB
Service --> Controller: 경매 정보
deactivate Service
Controller -> BidService: bidWrite()
activate BidService
BidService -> BidService: 작성자 본인 입찰 방지
BidService -> BidService: 최소 입찰 금액 검증
BidService -> DB: SELECT MAX(BID_AMOUNT) FROM BID1
activate DB
DB --> BidService: 최고 입찰 금액
deactivate DB
BidService -> BidService: 입찰 금액 검증
BidService -> DB: INSERT INTO BID1
activate DB
DB --> BidService: 성공
deactivate DB
BidService --> Controller: 결과 반환
deactivate BidService
Controller --> Frontend: JSON 응답
deactivate Controller
Frontend --> User: 입찰 완료
deactivate Frontend

== 입찰 내역 조회 ==
User -> Frontend: 입찰 내역 조회
activate Frontend
Frontend -> Controller: GET /bid/list?imageboardSeq=1
activate Controller
Controller -> BidService: bidList()
activate BidService
BidService -> DB: SELECT FROM BID1 WHERE IMAGEBOARD_SEQ=1
activate DB
DB --> BidService: 입찰 내역
deactivate DB
BidService --> Controller: 입찰 내역
deactivate BidService
Controller --> Frontend: JSON 응답
deactivate Controller
Frontend --> User: 입찰 내역 표시
deactivate Frontend

@enduml


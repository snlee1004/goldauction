# ê³¨ë“œì˜¥ì…˜ ë°°í¬ ê°€ì´ë“œ

## ğŸ“‹ ëª©ì°¨
1. [Oracle Cloud VM ì„¤ì •](#oracle-cloud-vm-ì„¤ì •)
2. [GitHub Actions ì„¤ì •](#github-actions-ì„¤ì •)
3. [ìë™ ë°°í¬ ì‹¤í–‰](#ìë™-ë°°í¬-ì‹¤í–‰)
4. [ìˆ˜ë™ ë°°í¬](#ìˆ˜ë™-ë°°í¬)

---

## ğŸ–¥ï¸ Oracle Cloud VM ì„¤ì •

### 1. VM ì¸ìŠ¤í„´ìŠ¤ ìƒì„±

1. **Oracle Cloud Console** ì ‘ì†
2. **Compute â†’ Instances â†’ Create Instance**
3. ì„¤ì •:
   - **Image**: Ubuntu 22.04
   - **Shape**: VM.Standard.A1.Flex (Always Free)
     - OCPUs: 2
     - Memory: 12GB
   - **Networking**: Public IP í• ë‹¹
   - **SSH Keys**: ê³µê°œí‚¤ ì¶”ê°€

### 2. VM ì´ˆê¸° ì„¤ì •

```bash
# VMì— SSH ì ‘ì†
ssh ubuntu@<VM_PUBLIC_IP>

# í”„ë¡œì íŠ¸ í´ë¡ 
git clone https://github.com/your-username/goldauction.git
cd goldauction

# ì´ˆê¸° ì„¤ì • ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
chmod +x scripts/setup-vm.sh
sudo ./scripts/setup-vm.sh
```

### 3. application.properties ì„¤ì •

```bash
# í”„ë¡œë•ì…˜ ì„¤ì • íŒŒì¼ ìƒì„±
sudo nano /opt/goldauction/backend/application.properties
```

```properties
# Oracle DB ì—°ê²° (ê°™ì€ VCN ë‚´ë¶€)
spring.datasource.url=jdbc:oracle:thin:@<DB_PRIVATE_IP>:1521:<SERVICE_NAME>
spring.datasource.username=<DB_USERNAME>
spring.datasource.password=<DB_PASSWORD>
spring.datasource.driver-class-name=oracle.jdbc.OracleDriver

# JPA ì„¤ì •
spring.jpa.hibernate.ddl-auto=none
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false

# íŒŒì¼ ì—…ë¡œë“œ ê²½ë¡œ
file.upload-dir=/opt/goldauction/uploads

# ì„œë²„ í¬íŠ¸
server.port=8080
```

---

## ğŸ”§ GitHub Actions ì„¤ì •

### 1. GitHub Secrets ì„¤ì •

**Repository â†’ Settings â†’ Secrets and variables â†’ Actions â†’ New repository secret**

ë‹¤ìŒ Secretsë¥¼ ì¶”ê°€:

| Secret ì´ë¦„ | ì„¤ëª… | ì˜ˆì‹œ |
|------------|------|------|
| `OCI_HOST` | VMì˜ Public IP | `123.456.789.0` |
| `OCI_USERNAME` | SSH ì‚¬ìš©ìëª… | `ubuntu` |
| `OCI_SSH_KEY` | SSH ê°œì¸í‚¤ (ì „ì²´ ë‚´ìš©) | `-----BEGIN RSA PRIVATE KEY-----...` |
| `OCI_PORT` | SSH í¬íŠ¸ (ì„ íƒì‚¬í•­) | `22` |

**SSH í‚¤ ìƒì„± ë°©ë²•:**
```bash
# ë¡œì»¬ì—ì„œ SSH í‚¤ ìƒì„±
ssh-keygen -t rsa -b 4096 -C "github-actions"

# ê³µê°œí‚¤ë¥¼ VMì— ì¶”ê°€
ssh-copy-id -i ~/.ssh/id_rsa.pub ubuntu@<VM_PUBLIC_IP>

# ê°œì¸í‚¤ ë‚´ìš© ë³µì‚¬ (GitHub Secretì— ì‚¬ìš©)
cat ~/.ssh/id_rsa
```

### 2. GitHub Actions ì›Œí¬í”Œë¡œìš° í™•ì¸

`.github/workflows/deploy.yml` íŒŒì¼ì´ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸:

```yaml
on:
  push:
    branches:
      - main  # main ë¸Œëœì¹˜ì— push ì‹œ ìë™ ë°°í¬
```

---

## ğŸš€ ìë™ ë°°í¬ ì‹¤í–‰

### 1. ì½”ë“œ Push

```bash
# main ë¸Œëœì¹˜ì— push
git add .
git commit -m "ë°°í¬ ì¤€ë¹„"
git push origin main
```

### 2. GitHub Actions í™•ì¸

1. **GitHub Repository â†’ Actions** íƒ­ ì´ë™
2. **Deploy to Oracle Cloud VM** ì›Œí¬í”Œë¡œìš° í™•ì¸
3. ì‹¤í–‰ ìƒíƒœ ëª¨ë‹ˆí„°ë§

### 3. ë°°í¬ ë¡œê·¸ í™•ì¸

```bash
# VMì— SSH ì ‘ì†
ssh ubuntu@<VM_PUBLIC_IP>

# ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ ë¡œê·¸ í™•ì¸
tail -f /home/ubuntu/deploy.log

# Backend ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
sudo systemctl status goldauction-backend

# Nginx ìƒíƒœ í™•ì¸
sudo systemctl status nginx
```

---

## ğŸ”„ ìˆ˜ë™ ë°°í¬

### 1. ë¡œì»¬ì—ì„œ ë¹Œë“œ

```bash
# Backend ë¹Œë“œ
cd backend
./gradlew bootJar

# Frontend ë¹Œë“œ
cd ../frontend
npm run build
```

### 2. VMì— ì—…ë¡œë“œ

```bash
# Backend JAR ì—…ë¡œë“œ
scp backend/build/libs/*.jar ubuntu@<VM_PUBLIC_IP>:/tmp/

# Frontend ë¹Œë“œ íŒŒì¼ ì—…ë¡œë“œ
scp -r frontend/dist/* ubuntu@<VM_PUBLIC_IP>:/tmp/frontend/
```

### 3. VMì—ì„œ ë°°í¬

```bash
# VMì— SSH ì ‘ì†
ssh ubuntu@<VM_PUBLIC_IP>

# ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
sudo /home/ubuntu/deploy.sh
```

---

## ğŸ” ë¬¸ì œ í•´ê²°

### Backend ì„œë¹„ìŠ¤ê°€ ì‹œì‘ë˜ì§€ ì•Šì„ ë•Œ

```bash
# ì„œë¹„ìŠ¤ ë¡œê·¸ í™•ì¸
sudo journalctl -u goldauction-backend -f

# ì„œë¹„ìŠ¤ ì¬ì‹œì‘
sudo systemctl restart goldauction-backend
```

### Nginx ì„¤ì • ì˜¤ë¥˜

```bash
# Nginx ì„¤ì • í…ŒìŠ¤íŠ¸
sudo nginx -t

# Nginx ì¬ì‹œì‘
sudo systemctl restart nginx
```

### í¬íŠ¸ ì¶©ëŒ

```bash
# 8080 í¬íŠ¸ ì‚¬ìš© ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ í™•ì¸
sudo lsof -i :8080

# í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ
sudo kill -9 <PID>
```

### ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì˜¤ë¥˜

```bash
# Oracle DB ì—°ê²° í…ŒìŠ¤íŠ¸
sqlplus <USERNAME>/<PASSWORD>@<DB_IP>:1521/<SERVICE_NAME>

# ë°©í™”ë²½ ê·œì¹™ í™•ì¸ (OCI Security List)
# - Ingress: 1521 í¬íŠ¸ í—ˆìš©
# - Source: VMì˜ Subnet CIDR
```

---

## ğŸ“ ì¶”ê°€ ì„¤ì •

### HTTPS ì„¤ì • (Let's Encrypt)

```bash
# Certbot ì„¤ì¹˜
sudo apt install certbot python3-certbot-nginx

# SSL ì¸ì¦ì„œ ë°œê¸‰
sudo certbot --nginx -d your-domain.com

# ìë™ ê°±ì‹  ì„¤ì •
sudo certbot renew --dry-run
```

### ë„ë©”ì¸ ì„¤ì •

1. **ë„ë©”ì¸ DNS ì„¤ì •**
   - A ë ˆì½”ë“œ: `@` â†’ VM Public IP
   - A ë ˆì½”ë“œ: `www` â†’ VM Public IP

2. **Nginx ì„¤ì • ìˆ˜ì •**
   ```bash
   sudo nano /etc/nginx/sites-available/goldauction
   # server_name _; â†’ server_name your-domain.com www.your-domain.com;
   ```

---

## âœ… ë°°í¬ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] Oracle Cloud VM ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
- [ ] VM ì´ˆê¸° ì„¤ì • ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
- [ ] application.properties ì„¤ì •
- [ ] GitHub Secrets ì„¤ì •
- [ ] SSH í‚¤ ì„¤ì •
- [ ] GitHub Actions ì›Œí¬í”Œë¡œìš° í…ŒìŠ¤íŠ¸
- [ ] Backend ì„œë¹„ìŠ¤ ì‹¤í–‰ í™•ì¸
- [ ] Frontend ì •ì  íŒŒì¼ ì„œë¹™ í™•ì¸
- [ ] ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í™•ì¸
- [ ] API ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸

---

## ğŸ“ ì§€ì›

ë¬¸ì œê°€ ë°œìƒí•˜ë©´:
1. GitHub Issuesì— ë“±ë¡
2. ë¡œê·¸ íŒŒì¼ í™•ì¸
3. ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸

